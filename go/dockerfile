#Build
FROM golang:1.22.0-alpine as builder
WORKDIR /app
#download all dependencies
COPY go/go.mod go/go.sum ./
RUN go mod tidy
COPY go/app/ ./


#main.go directory
RUN go build -o main .


RUN addgroup -S mercari && adduser -S trainee -G mercari
COPY mercari.sqlite3 ./mercari.sqlite3
RUN chown -R trainee:mercari ./
USER trainee
EXPOSE 9000
CMD ["./main"]
